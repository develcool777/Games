var I=Object.defineProperty;var L=(t,e,s)=>e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var o=(t,e,s)=>(L(t,typeof e!="symbol"?e+"":e,s),s);import{M as q}from"./Main-7ac9b8f1.js";import{d as g,h as c,_ as f,c as _,a as v,w as b,T as M,n as m,o as d,i as w,F as P,j as z,e as k,p as R,f as B,g as u,r as p,k as H,l as D,m as C,q as E,t as G}from"./index-5bf71e99.js";const W=g({name:"Cell",props:{cell:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0},isWin:{type:Boolean,required:!0}},setup(t){const e=c(!1),s=n=>t.cell===n||r(n),r=n=>t.cell===""&&t.player===n&&e.value;return{isHovered:e,isShow:s,defineHovered:r}}});function O(t,e,s,r,n,a){return d(),_("button",{type:"button",class:m(["cell",{win:t.isWin}]),title:"cell",onMouseover:e[0]||(e[0]=l=>t.isHovered=t.gameStatus==="start"),onMouseleave:e[1]||(e[1]=l=>t.isHovered=!1)},[v(M,{name:"fade"},{default:b(()=>[t.isShow("o")?(d(),_("div",{key:0,class:m(["cell__o",{hovered:t.defineHovered("o")}])},null,2)):w("",!0)]),_:1}),v(M,{name:"fade"},{default:b(()=>[t.isShow("x")?(d(),_("div",{key:0,class:m(["cell__x",{hovered:t.defineHovered("x")}])},null,2)):w("",!0)]),_:1})],34)}const V=f(W,[["render",O],["__scopeId","data-v-6348619e"]]),A=g({name:"Board",components:{Cell:V},props:{board:{type:Object,required:!0},gameStatus:{type:String,required:!0},player:{type:String,required:!0},winCells:{type:Array,required:!0}},emits:["makeMove"],setup(t,e){return{makeMove:r=>{t.gameStatus==="start"&&e.emit("makeMove",r)}}}});const $=t=>(R("data-v-2955ad3b"),t=t(),B(),t),x={class:"field"},F=$(()=>u("div",{class:"field__line v1"},null,-1)),j=$(()=>u("div",{class:"field__line v2"},null,-1)),N=$(()=>u("div",{class:"field__line horizontal h1"},null,-1)),U=$(()=>u("div",{class:"field__line horizontal h2"},null,-1));function X(t,e,s,r,n,a){const l=p("Cell");return d(),_("section",x,[(d(!0),_(P,null,z(t.board.flat(),(i,h)=>(d(),k(l,{gameStatus:t.gameStatus,player:t.player,isWin:t.winCells.includes(h),cell:i,key:h,onClick:y=>t.makeMove(h)},null,8,["gameStatus","player","isWin","cell","onClick"]))),128)),F,j,N,U])}const J=f(A,[["render",X],["__scopeId","data-v-2955ad3b"]]),K=(t,e)=>{const s=t[e];return s?typeof s=="function"?s():Promise.resolve(s):new Promise((r,n)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+e)))})},Q=g({name:"SvgIcon",props:{name:{type:String,required:!0},disableTransition:{type:Boolean,default:!1},disableColorinheritance:{type:Boolean,default:!1}},setup(t){return{svgComponent:H(()=>D(()=>K(Object.assign({"./icons/Cancel.vue":()=>C(()=>import("./Cancel-639befbf.js"),["assets/Cancel-639befbf.js","assets/index-5bf71e99.js","assets/index-863553dd.css"]),"./icons/Play.vue":()=>C(()=>import("./Play-bd1bc31b.js"),["assets/Play-bd1bc31b.js","assets/index-5bf71e99.js","assets/index-863553dd.css"]),"./icons/Return.vue":()=>C(()=>import("./Return-7dcf5a10.js"),["assets/Return-7dcf5a10.js","assets/index-5bf71e99.js","assets/index-863553dd.css"])}),`./icons/${t.name}.vue`))),defineClass:()=>({inherit:!t.disableColorinheritance,tr:!t.disableTransition})}}});function Y(t,e,s,r,n,a){return d(),k(E(t.svgComponent),{class:m(["SVG",t.defineClass()])},null,8,["class"])}const Z=f(Q,[["render",Y]]),ee=g({name:"Settings",components:{SvgIcon:Z},props:{gameStatus:{type:String,required:!0},historyLen:{type:Number,required:!0}},emits:["start","cancel","returnMove"],setup(t,e){return{start:()=>{t.gameStatus!=="start"&&e.emit("start")},cancel:()=>{t.gameStatus!==""&&e.emit("cancel")},returnMove:()=>{t.gameStatus!=="start"||t.historyLen===0||e.emit("returnMove")}}}});const te={class:"set"},se={class:"set__btns"},re={type:"button",title:"Cancel"},ne={type:"button",title:"Return move"};function ae(t,e,s,r,n,a){const l=p("SvgIcon");return d(),_("section",te,[u("div",se,[u("button",{type:"button",title:"Play",onClick:e[0]||(e[0]=i=>t.start())},[v(l,{name:"Play",class:"set__svg"})]),u("button",re,[v(l,{name:"Cancel",class:"set__svg",onClick:e[1]||(e[1]=i=>t.cancel())})]),u("button",ne,[v(l,{name:"Return",class:"set__svg",onClick:e[2]||(e[2]=i=>t.returnMove())})])])])}const oe=f(ee,[["render",ae],["__scopeId","data-v-7686c1c8"]]),ie=g({name:"Panel",props:{result:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0}},setup(t){return{specifyResult:()=>{switch(t.result){case"x":return"Winner X";case"o":return"Winner O";case"d":return"Draw";case"":return""}},defineClass:r=>t.gameStatus===""?"":t.gameStatus==="start"?t.player===r?"active":"":t.result===r?"win":t.result==="d"?"draw":"lose"}}});const T=t=>(R("data-v-8e7a4a35"),t=t(),B(),t),le={class:"panel"},ue=T(()=>u("div",{class:"panel__x"},null,-1)),de=[ue],ce=T(()=>u("p",{class:"panel__vs"},"VS",-1)),ve=T(()=>u("div",{class:"panel__o"},null,-1)),he=[ve],_e={key:0,class:"panel__result"};function pe(t,e,s,r,n,a){return d(),_("section",le,[u("div",{class:m(["panel__side left",t.defineClass("x")])},de,2),ce,u("div",{class:m(["panel__side rigth",t.defineClass("o")])},he,2),v(M,{name:"fade"},{default:b(()=>[t.result!==""?(d(),_("div",_e,G(t.specifyResult()),1)):w("",!0)]),_:1})])}const me=f(ie,[["render",pe],["__scopeId","data-v-8e7a4a35"]]);class ge{constructor(){o(this,"player");o(this,"board");o(this,"boardSize");o(this,"result");o(this,"history");o(this,"computer");o(this,"gameStatus");o(this,"winCells");o(this,"index1DTo2D",e=>({x:Math.floor(e/this.boardSize.value),y:e%this.boardSize.value}));o(this,"index2Dto1D",e=>e.x*this.boardSize.value+e.y);o(this,"userMove",e=>{if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.board.value[e.x][e.y]===void 0)throw Error("Wrong coordinates");if(this.board.value[e.x][e.y]!=="")throw Error("Cell is not empty");this.makeMove(e),this.computer.value.isComp&&this.compMove(),this.result.value!==""&&this.finishGame()});o(this,"makeMove",e=>{this.board.value[e.x][e.y]=this.player.value,this.history.value.push({...e,cell:this.player.value}),this.player.value=this.player.value==="x"?"o":"x",this.result.value=this.defineResult()});o(this,"compMove",()=>{if(this.result.value!=="")return;const e=this.getAvailableMoves;switch(this.computer.value.mode){case"easy":return this.makeMove(e[Math.floor(Math.random()*e.length)]);case"hard":return this.makeMove(e[Math.floor(Math.random()*e.length)])}});o(this,"reset",()=>{this.player.value="x",this.result.value="",this.board.value=[["","",""],["","",""],["","",""]],this.board.value=this.createBoard(),this.gameStatus.value="",this.history.value=[],this.winCells.value=[]});o(this,"createBoard",()=>{const e=[];for(let s=0;s<this.boardSize.value;s++){const r=[];for(let n=0;n<this.boardSize.value;n++)r.push("");e.push(r)}return e});o(this,"returnMove",()=>{var e,s;if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.getHistoryLength===0)throw Error("History is empty");this.removeMove(),this.computer.value.isComp&&this.getHistoryLength!==0&&(this.computer.value.isFirst?"x":"o")!==((e=this.history.value.at(-1))==null?void 0:e.cell)&&this.removeMove(),this.player.value=((s=this.history.value.at(-1))==null?void 0:s.cell)??"x"});o(this,"removeMove",()=>{const e=this.history.value.pop();e!==void 0&&(this.board.value[e.x][e.y]="")});o(this,"defineResult",()=>{switch(this.boardSize.value){case 3:return this.defineResult3x3();case 5:return this.defineResult5x5();case 7:return""}});o(this,"defineResult3x3",()=>{if(this.getHistoryLength<5)return"";const e=(n,a,l)=>n===a&&a===l&&n!=="",s=(n,a)=>{this.winCells.value.push(...r.map((l,i)=>{switch(n){case"row":return{x:a,y:i};case"col":return{x:i,y:a};case"d1":return{x:i,y:i};case"d2":return{x:i,y:2-i}}}))},r=this.board.value;return e(r[0][0],r[0][1],r[0][2])?(s("row",0),r[0][0]):e(r[1][0],r[1][1],r[1][2])?(s("row",1),r[1][0]):e(r[2][0],r[2][1],r[2][2])?(s("row",2),r[2][0]):e(r[0][0],r[1][0],r[2][0])?(s("col",0),r[0][0]):e(r[0][1],r[1][1],r[2][1])?(s("col",1),r[0][1]):e(r[0][2],r[1][2],r[2][2])?(s("col",2),r[0][2]):e(r[0][0],r[1][1],r[2][2])?(s("d1"),r[1][1]):e(r[0][2],r[1][1],r[2][0])?(s("d2"),r[1][1]):this.getHistoryLength===this.amoutOfCells?"d":""});o(this,"defineResult5x5",()=>{if(this.getHistoryLength<7)return"";const e=a=>{const l=a.reduce((i,h,y)=>(y!==0||i.at(-1)!==h||i.at(-1)===""?i=[]:i.push(h),i),[]);return l.length===4?l[0]:""},s=this.board.value;let r="";for(let a=0;a<this.boardSize.value;a++)if(r=e(s[a]),r!=="")return r;for(let a=0;a<this.boardSize.value;a++)if(r=e(s.map(l=>l[a])),r!=="")return r;const n=[[s[0][0],s[1][1],s[2][2],s[3][3],s[4][4]],[s[1][0],s[2][1],s[3][2],s[4][3]],[s[0][1],s[1][2],s[2][3],s[3][4]],[s[0][4],s[1][3],s[2][2],s[3][1],s[4][0]],[s[0][3],s[1][2],s[2][1],s[3][0]],[s[1][4],s[2][3],s[3][2],s[4][1]]];for(let a=0;a<n.length;a++)if(r=e(n[a]),r!=="")return r;return this.getHistoryLength===this.amoutOfCells?"d":r});o(this,"startGame",()=>{this.gameStatus.value="start",this.computer.value.isComp&&this.computer.value.isFirst&&this.compMove()});o(this,"finishGame",()=>{this.gameStatus.value="finish"});this.player=c("x"),this.result=c(""),this.boardSize=c(3),this.board=c(this.createBoard()),this.computer=c({isComp:!1,isFirst:!1,mode:"easy"}),this.gameStatus=c(""),this.history=c([]),this.winCells=c([])}get getPlayer(){return this.player.value}get getBoard(){return this.board.value}get getBoardSize(){return this.boardSize.value}get getResult(){return this.result.value}get getGameStatus(){return this.gameStatus.value}get getHistoryLength(){return this.history.value.length}get getWinCells(){return this.winCells.value.map(e=>this.index2Dto1D(e))}get amoutOfCells(){return Math.pow(this.boardSize.value,2)}get getAvailableMoves(){return this.board.value.reduce((e,s,r)=>(s.forEach((n,a)=>{n===""&&e.push({x:r,y:a})}),e),[])}}const fe=g({name:"TicTacToe",components:{Main:q,Board:J,Settings:oe,Panel:me},setup(){return{g:new ge}}});const ye={class:"tic__game"};function Se(t,e,s,r,n,a){const l=p("Panel"),i=p("Board"),h=p("Settings"),y=p("Main");return d(),k(y,{class:"tic"},{default:b(()=>[u("div",ye,[v(l,{"game-status":t.g.getGameStatus,result:t.g.getResult,player:t.g.getPlayer},null,8,["game-status","result","player"]),v(i,{winCells:t.g.getWinCells,player:t.g.getPlayer,gameStatus:t.g.getGameStatus,board:t.g.getBoard,onMakeMove:e[0]||(e[0]=S=>t.g.userMove(t.g.index1DTo2D(S)))},null,8,["winCells","player","gameStatus","board"])]),v(h,{historyLen:t.g.getHistoryLength,gameStatus:t.g.getGameStatus,onReturnMove:e[1]||(e[1]=S=>t.g.returnMove()),onStart:e[2]||(e[2]=S=>t.g.startGame()),onCancel:e[3]||(e[3]=S=>t.g.reset())},null,8,["historyLen","gameStatus"])]),_:1})}const Me=f(fe,[["render",Se],["__scopeId","data-v-8b6720b6"]]);export{Me as default};
