var T=Object.defineProperty;var I=(t,e,r)=>e in t?T(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var n=(t,e,r)=>(I(t,typeof e!="symbol"?e+"":e,r),r);import{M as R}from"./Main-e29831ae.js";import{d as m,h as d,_ as h,c as p,a as v,w as $,T as w,n as f,o as u,i as k,F as q,j as L,e as C,p as B,f as E,g as c,r as _,k as H,l as D,m as b,q as P,s as z}from"./index-768ae000.js";const G=m({name:"Cell",props:{cell:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0},isWin:{type:Boolean,required:!0}},setup(t){const e=d(!1),r=a=>t.cell===a||s(a),s=a=>t.cell===""&&t.player===a&&e.value;return{isHovered:e,isShow:r,defineHovered:s}}});function V(t,e,r,s,a,o){return u(),p("button",{type:"button",class:f(["cell",{win:t.isWin}]),onMouseover:e[0]||(e[0]=l=>t.isHovered=t.gameStatus==="start"),onMouseleave:e[1]||(e[1]=l=>t.isHovered=!1)},[v(w,{name:"fade"},{default:$(()=>[t.isShow("o")?(u(),p("div",{key:0,class:f(["cell__o",{hovered:t.defineHovered("o")}])},null,2)):k("",!0)]),_:1}),v(w,{name:"fade"},{default:$(()=>[t.isShow("x")?(u(),p("div",{key:0,class:f(["cell__x",{hovered:t.defineHovered("x")}])},null,2)):k("",!0)]),_:1})],34)}const W=h(G,[["render",V],["__scopeId","data-v-71e647e1"]]),A=m({name:"Board",components:{Cell:W},props:{board:{type:Object,required:!0},gameStatus:{type:String,required:!0},player:{type:String,required:!0},winCells:{type:Array,required:!0}},emits:["makeMove"],setup(t,e){return{makeMove:s=>{t.gameStatus==="start"&&e.emit("makeMove",s)}}}});const S=t=>(B("data-v-2955ad3b"),t=t(),E(),t),O={class:"field"},x=S(()=>c("div",{class:"field__line v1"},null,-1)),F=S(()=>c("div",{class:"field__line v2"},null,-1)),N=S(()=>c("div",{class:"field__line horizontal h1"},null,-1)),j=S(()=>c("div",{class:"field__line horizontal h2"},null,-1));function U(t,e,r,s,a,o){const l=_("Cell");return u(),p("section",O,[(u(!0),p(q,null,L(t.board.flat(),(i,g)=>(u(),C(l,{gameStatus:t.gameStatus,player:t.player,isWin:t.winCells.includes(g),cell:i,key:g,onClick:M=>t.makeMove(g)},null,8,["gameStatus","player","isWin","cell","onClick"]))),128)),x,F,N,j])}const J=h(A,[["render",U],["__scopeId","data-v-2955ad3b"]]),K=(t,e)=>{const r=t[e];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((s,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+e)))})},Q=m({name:"SvgIcon",props:{name:{type:String,required:!0},disableTransition:{type:Boolean,default:!1},disableColorinheritance:{type:Boolean,default:!1}},setup(t){return{svgComponent:H(()=>D(()=>K(Object.assign({"./icons/Cancel.vue":()=>b(()=>import("./Cancel-b3531e71.js"),["assets/Cancel-b3531e71.js","assets/index-768ae000.js","assets/index-863553dd.css"]),"./icons/Play.vue":()=>b(()=>import("./Play-8c27cbbc.js"),["assets/Play-8c27cbbc.js","assets/index-768ae000.js","assets/index-863553dd.css"]),"./icons/Return.vue":()=>b(()=>import("./Return-adedd962.js"),["assets/Return-adedd962.js","assets/index-768ae000.js","assets/index-863553dd.css"])}),`./icons/${t.name}.vue`))),defineClass:()=>({inherit:!t.disableColorinheritance,tr:!t.disableTransition})}}});function X(t,e,r,s,a,o){return u(),C(P(t.svgComponent),{class:f(["SVG",t.defineClass()])},null,8,["class"])}const Y=h(Q,[["render",X]]),Z=m({name:"Settings",components:{SvgIcon:Y},props:{gameStatus:{type:String,required:!0},historyLen:{type:Number,required:!0}},emits:["start","cancel","returnMove"],setup(t,e){return{start:()=>{t.gameStatus!=="start"&&e.emit("start")},cancel:()=>{t.gameStatus!==""&&e.emit("cancel")},returnMove:()=>{t.gameStatus!=="start"||t.historyLen===0||e.emit("returnMove")}}}});const ee={class:"set"},te={class:"set__btns"},se={type:"button",title:"Cancel"},re={type:"button",title:"Return move"};function ae(t,e,r,s,a,o){const l=_("SvgIcon");return u(),p("section",ee,[c("div",te,[c("button",{type:"button",title:"Play",onClick:e[0]||(e[0]=i=>t.start())},[v(l,{name:"Play",class:"set__svg"})]),c("button",se,[v(l,{name:"Cancel",class:"set__svg",onClick:e[1]||(e[1]=i=>t.cancel())})]),c("button",re,[v(l,{name:"Return",class:"set__svg",onClick:e[2]||(e[2]=i=>t.returnMove())})])])])}const ne=h(Z,[["render",ae],["__scopeId","data-v-7686c1c8"]]),oe=m({name:"Result",props:{result:{type:String,required:!0},player:{type:String,required:!0}},setup(){return{}}});const ie={class:"result"},le=z('<div class="result__panel" data-v-0b903ab2><div class="result__side left" data-v-0b903ab2><div class="result__x" data-v-0b903ab2></div></div><p class="result__vs" data-v-0b903ab2>VS</p><div class="result__side rigth" data-v-0b903ab2><div class="result__o" data-v-0b903ab2></div></div></div>',1),ue=[le];function de(t,e,r,s,a,o){return u(),p("section",ie,ue)}const ce=h(oe,[["render",de],["__scopeId","data-v-0b903ab2"]]);class ve{constructor(){n(this,"player");n(this,"board");n(this,"boardSize");n(this,"result");n(this,"history");n(this,"computer");n(this,"gameStatus");n(this,"winCells");n(this,"index1DTo2D",e=>({x:Math.floor(e/this.boardSize.value),y:e%this.boardSize.value}));n(this,"index2Dto1D",e=>e.x*this.boardSize.value+e.y);n(this,"userMove",e=>{if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.board.value[e.x][e.y]===void 0)throw Error("Wrong coordinates");if(this.board.value[e.x][e.y]!=="")throw Error("Cell is not empty");this.makeMove(e),this.computer.value.isComp&&this.compMove(),this.result.value!==""&&this.finishGame()});n(this,"makeMove",e=>{this.board.value[e.x][e.y]=this.player.value,this.history.value.push({...e,cell:this.player.value}),this.player.value=this.player.value==="x"?"o":"x",this.result.value=this.defineResult()});n(this,"compMove",()=>{if(this.result.value!=="")return;const e=this.getAvailableMoves;switch(this.computer.value.mode){case"easy":return this.makeMove(e[Math.floor(Math.random()*e.length)]);case"hard":return this.makeMove(e[Math.floor(Math.random()*e.length)])}});n(this,"reset",()=>{this.player.value="x",this.result.value="",this.board.value=[["","",""],["","",""],["","",""]],this.gameStatus.value="",this.history.value=[],this.winCells.value=[]});n(this,"returnMove",()=>{var e,r;if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.getHistoryLength===0)throw Error("History is empty");this.removeMove(),this.computer.value.isComp&&this.getHistoryLength!==0&&(this.computer.value.isFirst?"x":"o")!==((e=this.history.value.at(-1))==null?void 0:e.cell)&&this.removeMove(),this.player.value=((r=this.history.value.at(-1))==null?void 0:r.cell)??"x"});n(this,"removeMove",()=>{const e=this.history.value.pop();e!==void 0&&(this.board.value[e.x][e.y]="")});n(this,"defineResult",()=>{if(this.getHistoryLength<5)return"";const e=(a,o,l)=>a===o&&o===l&&a!=="",r=(a,o)=>{this.winCells.value.push(...s.map((l,i)=>{switch(a){case"row":return{x:o,y:i};case"col":return{x:i,y:o};case"d1":return{x:i,y:i};case"d2":return{x:i,y:2-i}}}))},s=this.board.value;return e(...s[0])?(r("row",0),s[0][0]):e(...s[1])?(r("row",1),s[1][0]):e(...s[2])?(r("row",2),s[2][0]):e(...s.map(a=>a[0]))?(r("col",0),s[0][0]):e(...s.map(a=>a[1]))?(r("col",1),s[0][1]):e(...s.map(a=>a[2]))?(r("col",2),s[0][2]):e(s[0][0],s[1][1],s[2][2])?(r("d1"),s[1][1]):e(s[0][2],s[1][1],s[2][0])?(r("d2"),s[1][1]):this.getHistoryLength===this.amoutOfCells?"d":""});n(this,"startGame",()=>{this.gameStatus.value="start",this.computer.value.isComp&&this.computer.value.isFirst&&this.compMove()});n(this,"finishGame",()=>{this.gameStatus.value="finish"});this.player=d("x"),this.result=d(""),this.board=d([["","",""],["","",""],["","",""]]),this.computer=d({isComp:!1,isFirst:!1,mode:"easy"}),this.gameStatus=d(""),this.boardSize=d(3),this.history=d([]),this.winCells=d([])}get getPlayer(){return this.player.value}get getBoard(){return this.board.value}get getBoardSize(){return this.boardSize.value}get getResult(){return this.result.value}get getGameStatus(){return this.gameStatus.value}get getHistoryLength(){return this.history.value.length}get getWinCells(){return this.winCells.value.map(e=>this.index2Dto1D(e))}get amoutOfCells(){return Math.pow(this.boardSize.value,2)}get getAvailableMoves(){return this.board.value.reduce((e,r,s)=>(r.forEach((a,o)=>{a===""&&e.push({x:s,y:o})}),e),[])}}const pe=m({name:"TicTacToe",components:{Main:R,Board:J,Settings:ne,Result:ce},setup(){return{g:new ve}}});const _e={class:"tic__game"};function me(t,e,r,s,a,o){const l=_("Result"),i=_("Board"),g=_("Settings"),M=_("Main");return u(),C(M,{class:"tic"},{default:$(()=>[c("div",_e,[v(l,{result:t.g.getResult,player:t.g.getPlayer},null,8,["result","player"]),v(i,{winCells:t.g.getWinCells,player:t.g.getPlayer,gameStatus:t.g.getGameStatus,board:t.g.getBoard,onMakeMove:e[0]||(e[0]=y=>t.g.userMove(t.g.index1DTo2D(y)))},null,8,["winCells","player","gameStatus","board"])]),v(g,{historyLen:t.g.getHistoryLength,gameStatus:t.g.getGameStatus,onReturnMove:e[1]||(e[1]=y=>t.g.returnMove()),onStart:e[2]||(e[2]=y=>t.g.startGame()),onCancel:e[3]||(e[3]=y=>t.g.reset())},null,8,["historyLen","gameStatus"])]),_:1})}const fe=h(pe,[["render",me],["__scopeId","data-v-cdc511cb"]]);export{fe as default};
