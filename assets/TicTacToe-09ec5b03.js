var P=Object.defineProperty;var L=(t,e,r)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var a=(t,e,r)=>(L(t,typeof e!="symbol"?e+"":e,r),r);import{M as B}from"./Main-1a08c8da.js";import{d as h,h as c,_ as g,c as _,a as v,w as S,T as b,n as p,o as d,i as M,F as D,j as R,e as w,p as I,f as q,g as o,r as m,k as E,l as H,m as C,q as G,t as z}from"./index-5626186f.js";const W=h({name:"Cell",props:{cell:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0},isWin:{type:Boolean,required:!0}},setup(t){const e=c(!1),r=n=>t.cell===n||s(n),s=n=>t.cell===""&&t.player===n&&e.value;return{isHovered:e,isShow:r,defineHovered:s}}});function O(t,e,r,s,n,i){return d(),_("button",{type:"button",class:p(["cell",{win:t.isWin}]),title:"cell",onMouseover:e[0]||(e[0]=u=>t.isHovered=t.gameStatus==="start"),onMouseleave:e[1]||(e[1]=u=>t.isHovered=!1)},[v(b,{name:"fade"},{default:S(()=>[t.isShow("o")?(d(),_("div",{key:0,class:p(["cell__o",{hovered:t.defineHovered("o")}])},null,2)):M("",!0)]),_:1}),v(b,{name:"fade"},{default:S(()=>[t.isShow("x")?(d(),_("div",{key:0,class:p(["cell__x",{hovered:t.defineHovered("x")}])},null,2)):M("",!0)]),_:1})],34)}const V=g(W,[["render",O],["__scopeId","data-v-6348619e"]]),A=h({name:"Board",components:{Cell:V},props:{board:{type:Object,required:!0},gameStatus:{type:String,required:!0},player:{type:String,required:!0},winCells:{type:Array,required:!0}},emits:["makeMove"],setup(t,e){return{makeMove:s=>{t.gameStatus==="start"&&e.emit("makeMove",s)}}}});const $=t=>(I("data-v-2955ad3b"),t=t(),q(),t),F={class:"field"},N=$(()=>o("div",{class:"field__line v1"},null,-1)),j=$(()=>o("div",{class:"field__line v2"},null,-1)),U=$(()=>o("div",{class:"field__line horizontal h1"},null,-1)),x=$(()=>o("div",{class:"field__line horizontal h2"},null,-1));function X(t,e,r,s,n,i){const u=m("Cell");return d(),_("section",F,[(d(!0),_(D,null,R(t.board.flat(),(l,f)=>(d(),w(u,{gameStatus:t.gameStatus,player:t.player,isWin:t.winCells.includes(f),cell:l,key:f,onClick:T=>t.makeMove(f)},null,8,["gameStatus","player","isWin","cell","onClick"]))),128)),N,j,U,x])}const J=g(A,[["render",X],["__scopeId","data-v-2955ad3b"]]),K=(t,e)=>{const r=t[e];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((s,n)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+e)))})},Q=h({name:"SvgIcon",props:{name:{type:String,required:!0},disableTransition:{type:Boolean,default:!1},disableColorinheritance:{type:Boolean,default:!1}},setup(t){return{svgComponent:E(()=>H(()=>K(Object.assign({"./icons/Cancel.vue":()=>C(()=>import("./Cancel-fa0be4fc.js"),["assets/Cancel-fa0be4fc.js","assets/index-5626186f.js","assets/index-863553dd.css"]),"./icons/Play.vue":()=>C(()=>import("./Play-6d4af45f.js"),["assets/Play-6d4af45f.js","assets/index-5626186f.js","assets/index-863553dd.css"]),"./icons/Return.vue":()=>C(()=>import("./Return-3be904d3.js"),["assets/Return-3be904d3.js","assets/index-5626186f.js","assets/index-863553dd.css"])}),`./icons/${t.name}.vue`))),defineClass:()=>({inherit:!t.disableColorinheritance,tr:!t.disableTransition})}}});function Y(t,e,r,s,n,i){return d(),w(G(t.svgComponent),{class:p(["SVG",t.defineClass()])},null,8,["class"])}const Z=g(Q,[["render",Y]]),ee=h({name:"Settings",components:{SvgIcon:Z},props:{gameStatus:{type:String,required:!0},historyLen:{type:Number,required:!0}},emits:["start","cancel","returnMove"],setup(t,e){return{start:()=>{t.gameStatus!=="start"&&e.emit("start")},cancel:()=>{t.gameStatus!==""&&e.emit("cancel")},returnMove:()=>{t.gameStatus!=="start"||t.historyLen===0||e.emit("returnMove")}}}});const te={class:"set"},se={class:"set__btns"},re={type:"button",title:"Cancel"},ne={type:"button",title:"Return move"};function ae(t,e,r,s,n,i){const u=m("SvgIcon");return d(),_("section",te,[o("div",se,[o("button",{type:"button",title:"Play",onClick:e[0]||(e[0]=l=>t.start())},[v(u,{name:"Play",class:"set__svg"})]),o("button",re,[v(u,{name:"Cancel",class:"set__svg",onClick:e[1]||(e[1]=l=>t.cancel())})]),o("button",ne,[v(u,{name:"Return",class:"set__svg",onClick:e[2]||(e[2]=l=>t.returnMove())})])])])}const oe=g(ee,[["render",ae],["__scopeId","data-v-7686c1c8"]]),ie=h({name:"Panel",props:{result:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0}},setup(t){return{specifyResult:()=>{switch(t.result){case"x":return"Winner X";case"o":return"Winner O";case"d":return"Draw";case"":return""}},defineClass:s=>t.gameStatus===""?"":t.gameStatus==="start"?t.player===s?"active":"":t.result===s?"win":t.result==="d"?"draw":"lose"}}});const k=t=>(I("data-v-9301da75"),t=t(),q(),t),le={class:"panel"},ue=k(()=>o("div",{class:"panel__x"},null,-1)),de=[ue],ce=k(()=>o("p",{class:"panel__vs"},"VS",-1)),ve=k(()=>o("div",{class:"panel__o"},null,-1)),_e=[ve],me={key:0,class:"panel__result"};function pe(t,e,r,s,n,i){return d(),_("section",le,[o("div",{class:p(["panel__side left",t.defineClass("x")])},de,2),ce,o("div",{class:p(["panel__side rigth",t.defineClass("o")])},_e,2),v(b,{name:"fade"},{default:S(()=>[t.result!==""?(d(),_("div",me,z(t.specifyResult()),1)):M("",!0)]),_:1})])}const he=g(ie,[["render",pe],["__scopeId","data-v-9301da75"]]);class ge{constructor(){a(this,"player");a(this,"board");a(this,"boardSize");a(this,"result");a(this,"history");a(this,"computer");a(this,"gameStatus");a(this,"winCells");a(this,"index1DTo2D",e=>({x:Math.floor(e/this.boardSize.value),y:e%this.boardSize.value}));a(this,"index2Dto1D",e=>e.x*this.boardSize.value+e.y);a(this,"userMove",e=>{if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.board.value[e.x][e.y]===void 0)throw Error("Wrong coordinates");if(this.board.value[e.x][e.y]!=="")throw Error("Cell is not empty");this.makeMove(e),this.computer.value.isComp&&this.compMove(),this.result.value!==""&&this.finishGame()});a(this,"makeMove",e=>{this.board.value[e.x][e.y]=this.player.value,this.history.value.push({...e,cell:this.player.value}),this.player.value=this.player.value==="x"?"o":"x",this.result.value=this.defineResult()});a(this,"compMove",()=>{if(this.result.value!=="")return;const e=this.getAvailableMoves;switch(this.computer.value.mode){case"easy":return this.makeMove(e[Math.floor(Math.random()*e.length)]);case"hard":return this.makeMove(e[Math.floor(Math.random()*e.length)])}});a(this,"reset",()=>{this.player.value="x",this.result.value="",this.board.value=[["","",""],["","",""],["","",""]],this.gameStatus.value="",this.history.value=[],this.winCells.value=[]});a(this,"returnMove",()=>{var e,r;if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.getHistoryLength===0)throw Error("History is empty");this.removeMove(),this.computer.value.isComp&&this.getHistoryLength!==0&&(this.computer.value.isFirst?"x":"o")!==((e=this.history.value.at(-1))==null?void 0:e.cell)&&this.removeMove(),this.player.value=((r=this.history.value.at(-1))==null?void 0:r.cell)??"x"});a(this,"removeMove",()=>{const e=this.history.value.pop();e!==void 0&&(this.board.value[e.x][e.y]="")});a(this,"defineResult",()=>{if(this.getHistoryLength<5)return"";const e=(n,i,u)=>n===i&&i===u&&n!=="",r=(n,i)=>{this.winCells.value.push(...s.map((u,l)=>{switch(n){case"row":return{x:i,y:l};case"col":return{x:l,y:i};case"d1":return{x:l,y:l};case"d2":return{x:l,y:2-l}}}))},s=this.board.value;return e(...s[0])?(r("row",0),s[0][0]):e(...s[1])?(r("row",1),s[1][0]):e(...s[2])?(r("row",2),s[2][0]):e(...s.map(n=>n[0]))?(r("col",0),s[0][0]):e(...s.map(n=>n[1]))?(r("col",1),s[0][1]):e(...s.map(n=>n[2]))?(r("col",2),s[0][2]):e(s[0][0],s[1][1],s[2][2])?(r("d1"),s[1][1]):e(s[0][2],s[1][1],s[2][0])?(r("d2"),s[1][1]):this.getHistoryLength===this.amoutOfCells?"d":""});a(this,"startGame",()=>{this.gameStatus.value="start",this.computer.value.isComp&&this.computer.value.isFirst&&this.compMove()});a(this,"finishGame",()=>{this.gameStatus.value="finish"});this.player=c("x"),this.result=c(""),this.board=c([["","",""],["","",""],["","",""]]),this.computer=c({isComp:!1,isFirst:!1,mode:"easy"}),this.gameStatus=c(""),this.boardSize=c(3),this.history=c([]),this.winCells=c([])}get getPlayer(){return this.player.value}get getBoard(){return this.board.value}get getBoardSize(){return this.boardSize.value}get getResult(){return this.result.value}get getGameStatus(){return this.gameStatus.value}get getHistoryLength(){return this.history.value.length}get getWinCells(){return this.winCells.value.map(e=>this.index2Dto1D(e))}get amoutOfCells(){return Math.pow(this.boardSize.value,2)}get getAvailableMoves(){return this.board.value.reduce((e,r,s)=>(r.forEach((n,i)=>{n===""&&e.push({x:s,y:i})}),e),[])}}const fe=h({name:"TicTacToe",components:{Main:B,Board:J,Settings:oe,Panel:he},setup(){return{g:new ge}}});const ye={class:"tic__game"};function Se(t,e,r,s,n,i){const u=m("Panel"),l=m("Board"),f=m("Settings"),T=m("Main");return d(),w(T,{class:"tic"},{default:S(()=>[o("div",ye,[v(u,{"game-status":t.g.getGameStatus,result:t.g.getResult,player:t.g.getPlayer},null,8,["game-status","result","player"]),v(l,{winCells:t.g.getWinCells,player:t.g.getPlayer,gameStatus:t.g.getGameStatus,board:t.g.getBoard,onMakeMove:e[0]||(e[0]=y=>t.g.userMove(t.g.index1DTo2D(y)))},null,8,["winCells","player","gameStatus","board"])]),v(f,{historyLen:t.g.getHistoryLength,gameStatus:t.g.getGameStatus,onReturnMove:e[1]||(e[1]=y=>t.g.returnMove()),onStart:e[2]||(e[2]=y=>t.g.startGame()),onCancel:e[3]||(e[3]=y=>t.g.reset())},null,8,["historyLen","gameStatus"])]),_:1})}const Me=g(fe,[["render",Se],["__scopeId","data-v-8b6720b6"]]);export{Me as default};
