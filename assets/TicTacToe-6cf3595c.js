var I=Object.defineProperty;var P=(e,t,s)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var i=(e,t,s)=>(P(e,typeof t!="symbol"?t+"":t,s),s);import{M as E}from"./Main-ba0c3856.js";import{d as f,h as p,_ as y,c as v,n as _,i as k,o as d,F as $,j as M,k as b,e as z,r as g,l as L,m as R,q as w,s as D,g as h,a as m,w as B,T as H,t as W,p as G,f as V}from"./index-11114782.js";const O=f({name:"Cell",props:{cell:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0},isWin:{type:Boolean,required:!0}},setup(e){const t=p(!1),s=r=>e.cell===r||a(r),a=r=>e.cell===""&&e.player===r&&t.value;return{isHovered:t,isShow:s,defineHovered:a}}});function F(e,t,s,a,r,u){return d(),v("button",{type:"button",class:_(["cell",{win:e.isWin}]),title:"cell",onMouseover:t[0]||(t[0]=n=>e.isHovered=e.gameStatus==="start"),onMouseleave:t[1]||(t[1]=n=>e.isHovered=!1)},[e.isShow("o")?(d(),v("div",{key:0,class:_(["cell__o",{hovered:e.defineHovered("o")}])},null,2)):k("",!0),e.isShow("x")?(d(),v("div",{key:1,class:_(["cell__x",{hovered:e.defineHovered("x")}])},null,2)):k("",!0)],34)}const A=y(O,[["render",F],["__scopeId","data-v-dcb579c1"]]),j=f({name:"Board",components:{Cell:A},props:{board:{type:Object,required:!0},gameStatus:{type:String,required:!0},player:{type:String,required:!0},winCells:{type:Array,required:!0}},emits:["makeMove"],setup(e,t){return{makeMove:(n,o)=>{e.gameStatus!=="start"||o!==""||t.emit("makeMove",n)},defineCellStyle:()=>{const n=e.board.length===3?"150px":"100px";return{width:n,height:n}},defineFieldStyle:()=>{const n=e.board.length===3?"490px":"560px";return{width:n,height:n}},defineVerticalStyle:(n,o)=>{const l=e.board.length===3?150:100;return o?{top:`${l+n*(l+10)}px`}:{left:`${l+n*(l+10)}px`}}}}});function N(e,t,s,a,r,u){const n=g("Cell");return d(),v("section",{class:"field",style:b(e.defineFieldStyle())},[(d(!0),v($,null,M(e.board.flat(),(o,l)=>(d(),z(n,{gameStatus:e.gameStatus,player:e.player,isWin:e.winCells.includes(l),cell:o,key:l,style:b(e.defineCellStyle()),onClick:S=>e.makeMove(l,o)},null,8,["gameStatus","player","isWin","cell","style","onClick"]))),128)),(d(!0),v($,null,M(e.board.length-1,(o,l)=>(d(),v("div",{class:"field__line",key:o,style:b(e.defineVerticalStyle(l))},null,4))),128)),(d(!0),v($,null,M(e.board.length-1,(o,l)=>(d(),v("div",{class:"field__line horizontal",key:o,style:b(e.defineVerticalStyle(l,!0))},null,4))),128))],4)}const U=y(j,[["render",N],["__scopeId","data-v-3394cdbd"]]),x=(e,t)=>{const s=e[t];return s?typeof s=="function"?s():Promise.resolve(s):new Promise((a,r)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(r.bind(null,new Error("Unknown variable dynamic import: "+t)))})},X=f({name:"SvgIcon",props:{name:{type:String,required:!0},disableTransition:{type:Boolean,default:!1},disableColorinheritance:{type:Boolean,default:!1}},setup(e){return{svgComponent:L(()=>R(()=>x(Object.assign({"./icons/Cancel.vue":()=>w(()=>import("./Cancel-3bd05b65.js"),["assets/Cancel-3bd05b65.js","assets/index-11114782.js","assets/index-863553dd.css"]),"./icons/Play.vue":()=>w(()=>import("./Play-b01c1b22.js"),["assets/Play-b01c1b22.js","assets/index-11114782.js","assets/index-863553dd.css"]),"./icons/Return.vue":()=>w(()=>import("./Return-4e32abc6.js"),["assets/Return-4e32abc6.js","assets/index-11114782.js","assets/index-863553dd.css"])}),`./icons/${e.name}.vue`))),defineClass:()=>({inherit:!e.disableColorinheritance,tr:!e.disableTransition})}}});function J(e,t,s,a,r,u){return d(),z(D(e.svgComponent),{class:_(["SVG",e.defineClass()])},null,8,["class"])}const K=y(X,[["render",J]]),Q=f({name:"Settings",components:{SvgIcon:K},props:{gameStatus:{type:String,required:!0},historyLen:{type:Number,required:!0}},emits:["start","cancel","returnMove"],setup(e,t){return{start:()=>{e.gameStatus!=="start"&&t.emit("start")},cancel:()=>{e.gameStatus!==""&&t.emit("cancel")},returnMove:()=>{e.gameStatus!=="start"||e.historyLen===0||t.emit("returnMove")}}}});const Y={class:"set"},Z={class:"set__btns"},ee={type:"button",title:"Cancel"},te={type:"button",title:"Return move"};function se(e,t,s,a,r,u){const n=g("SvgIcon");return d(),v("section",Y,[h("div",Z,[h("button",{type:"button",title:"Play",onClick:t[0]||(t[0]=o=>e.start())},[m(n,{name:"Play",class:"set__svg"})]),h("button",ee,[m(n,{name:"Cancel",class:"set__svg",onClick:t[1]||(t[1]=o=>e.cancel())})]),h("button",te,[m(n,{name:"Return",class:"set__svg",onClick:t[2]||(t[2]=o=>e.returnMove())})])])])}const re=y(Q,[["render",se],["__scopeId","data-v-7686c1c8"]]),ne=f({name:"Panel",props:{result:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0}},setup(e){return{specifyResult:()=>{switch(e.result){case"x":return"Winner X";case"o":return"Winner O";case"d":return"Draw";case"":return""}},defineClass:a=>e.gameStatus===""?"":e.gameStatus==="start"?e.player===a?"active":"":e.result===a?"win":e.result==="d"?"draw":"lose"}}});const T=e=>(G("data-v-8e7a4a35"),e=e(),V(),e),ae={class:"panel"},oe=T(()=>h("div",{class:"panel__x"},null,-1)),ie=[oe],le=T(()=>h("p",{class:"panel__vs"},"VS",-1)),ue=T(()=>h("div",{class:"panel__o"},null,-1)),de=[ue],ce={key:0,class:"panel__result"};function ve(e,t,s,a,r,u){return d(),v("section",ae,[h("div",{class:_(["panel__side left",e.defineClass("x")])},ie,2),le,h("div",{class:_(["panel__side rigth",e.defineClass("o")])},de,2),m(H,{name:"fade"},{default:B(()=>[e.result!==""?(d(),v("div",ce,W(e.specifyResult()),1)):k("",!0)]),_:1})])}const he=y(ne,[["render",ve],["__scopeId","data-v-8e7a4a35"]]);class pe{constructor(t=3){i(this,"player");i(this,"board");i(this,"boardSize");i(this,"result");i(this,"history");i(this,"computer");i(this,"gameStatus");i(this,"winCells");i(this,"index1DTo2D",t=>({x:Math.floor(t/this.boardSize.value),y:t%this.boardSize.value}));i(this,"index2Dto1D",t=>t.x*this.boardSize.value+t.y);i(this,"userMove",t=>{if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.board.value[t.x][t.y]===void 0)throw Error("Wrong coordinates");if(this.board.value[t.x][t.y]!=="")throw Error("Cell is not empty");this.makeMove(t),this.computer.value.isComp&&this.compMove(),this.result.value!==""&&this.finishGame()});i(this,"makeMove",t=>{this.board.value[t.x][t.y]=this.player.value,this.history.value.push({...t,cell:this.player.value}),this.player.value=this.player.value==="x"?"o":"x",this.defineResult()});i(this,"compMove",()=>{if(this.result.value!=="")return;const t=this.getAvailableMoves;switch(this.computer.value.mode){case"easy":return this.makeMove(t[Math.floor(Math.random()*t.length)]);case"hard":return this.makeMove(t[Math.floor(Math.random()*t.length)])}});i(this,"reset",()=>{this.player.value="x",this.result.value="",this.board.value=[["","",""],["","",""],["","",""]],this.board.value=this.createBoard(),this.gameStatus.value="",this.history.value=[],this.winCells.value=[]});i(this,"createBoard",()=>{const t=[];for(let s=0;s<this.boardSize.value;s++){const a=[];for(let r=0;r<this.boardSize.value;r++)a.push("");t.push(a)}return t});i(this,"returnMove",()=>{var t,s;if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.getHistoryLength===0)throw Error("History is empty");this.removeMove(),this.computer.value.isComp&&this.getHistoryLength!==0&&(this.computer.value.isFirst?"x":"o")!==((t=this.history.value.at(-1))==null?void 0:t.cell)&&this.removeMove(),this.player.value=((s=this.history.value.at(-1))==null?void 0:s.cell)??"x"});i(this,"removeMove",()=>{const t=this.history.value.pop();t!==void 0&&(this.board.value[t.x][t.y]="")});i(this,"defineResult",()=>{const t=this.boardSize.value===3?5:7;if(this.getHistoryLength<t)return;const s=(r,u)=>{if(r.length!==u.length)throw Error("row and rowCoordinates do not have same length");let n=[];const o=this.boardSize.value===3?3:4,l=r.reduce((c,C,q)=>(c.length===o||((C===""||c.length!==0&&c.at(-1)!==C)&&(c=[],n=[]),c.push(C),n.push(u[q])),c),[]),S=l.length===o;return S&&(this.result.value=l[0],this.winCells.value=n),S},a=this.board.value;for(let r=0;r<this.boardSize.value;r++){const u=a.map((n,o)=>({x:r,y:o}));if(s(a[r],u))return}for(let r=0;r<this.boardSize.value;r++){const u=a.map(o=>o[r]),n=a.map((o,l)=>({x:l,y:r}));if(s(u,n))return}this.result.value=this.getHistoryLength===this.amoutOfCells?"d":""});i(this,"startGame",()=>{this.gameStatus.value="start",this.computer.value.isComp&&this.computer.value.isFirst&&this.compMove()});i(this,"finishGame",()=>{this.gameStatus.value="finish"});if(![3,5,7].includes(t))throw Error("Wrong size for boardSize, expected: 3, 5, 7");this.player=p("x"),this.result=p(""),this.boardSize=p(t),this.board=p(this.createBoard()),this.computer=p({isComp:!1,isFirst:!1,mode:"easy"}),this.gameStatus=p(""),this.history=p([]),this.winCells=p([])}get getPlayer(){return this.player.value}get getBoard(){return this.board.value}get getBoardSize(){return this.boardSize.value}get getResult(){return this.result.value}get getGameStatus(){return this.gameStatus.value}get getHistoryLength(){return this.history.value.length}get getWinCells(){return this.winCells.value.map(t=>this.index2Dto1D(t))}get amoutOfCells(){return Math.pow(this.boardSize.value,2)}get getAvailableMoves(){return this.board.value.reduce((t,s,a)=>(s.forEach((r,u)=>{r===""&&t.push({x:a,y:u})}),t),[])}}const me=f({name:"TicTacToe",components:{Main:E,Board:U,Settings:re,Panel:he},setup(){return{g:new pe(5)}}});const ge={class:"tic__game"};function _e(e,t,s,a,r,u){const n=g("Panel"),o=g("Board"),l=g("Settings"),S=g("Main");return d(),z(S,{class:"tic"},{default:B(()=>[h("div",ge,[m(n,{"game-status":e.g.getGameStatus,result:e.g.getResult,player:e.g.getPlayer},null,8,["game-status","result","player"]),m(o,{winCells:e.g.getWinCells,player:e.g.getPlayer,gameStatus:e.g.getGameStatus,board:e.g.getBoard,onMakeMove:t[0]||(t[0]=c=>e.g.userMove(e.g.index1DTo2D(c)))},null,8,["winCells","player","gameStatus","board"])]),m(l,{historyLen:e.g.getHistoryLength,gameStatus:e.g.getGameStatus,onReturnMove:t[1]||(t[1]=c=>e.g.returnMove()),onStart:t[2]||(t[2]=c=>e.g.startGame()),onCancel:t[3]||(t[3]=c=>e.g.reset())},null,8,["historyLen","gameStatus"])]),_:1})}const be=y(me,[["render",_e],["__scopeId","data-v-9f7f100f"]]);export{be as default};
