var I=Object.defineProperty;var D=(e,t,r)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var u=(e,t,r)=>(D(e,typeof t!="symbol"?t+"":t,r),r);import{M as P}from"./Main-c580773a.js";import{d as y,h as p,_ as S,c as m,n as g,i as M,o as h,F as C,j as $,k as b,e as w,r as f,l as R,m as W,q as z,s as E,g as c,a as _,p as B,f as T,w as q,T as L,t as H}from"./index-028351f6.js";const G=y({name:"Cell",props:{cell:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0},isWin:{type:Boolean,required:!0}},setup(e){const t=p(!1),r=s=>e.cell===s||i(s),i=s=>e.cell===""&&e.player===s&&t.value;return{isHovered:t,isShow:r,defineHovered:i}}});function V(e,t,r,i,s,d){return h(),m("button",{type:"button",class:g(["cell",{win:e.isWin}]),title:"cell",onMouseover:t[0]||(t[0]=a=>e.isHovered=e.gameStatus==="start"),onMouseleave:t[1]||(t[1]=a=>e.isHovered=!1)},[e.isShow("o")?(h(),m("div",{key:0,class:g(["cell__o",{hovered:e.defineHovered("o")}])},null,2)):M("",!0),e.isShow("x")?(h(),m("div",{key:1,class:g(["cell__x",{hovered:e.defineHovered("x")}])},null,2)):M("",!0)],34)}const O=S(G,[["render",V],["__scopeId","data-v-a4462563"]]),j=y({name:"Board",components:{Cell:O},props:{board:{type:Object,required:!0},gameStatus:{type:String,required:!0},player:{type:String,required:!0},winCells:{type:Array,required:!0}},emits:["makeMove"],setup(e,t){return{makeMove:(a,n)=>{e.gameStatus!=="start"||n!==""||t.emit("makeMove",a)},defineCellStyle:()=>{const a=e.board.length===3?"150px":e.board.length===5?"100px":"80px";return{width:a,height:a}},defineFieldStyle:()=>{const a=e.board.length===3?"490px":e.board.length===5?"560px":"640px";return{width:a,height:a}},defineVerticalStyle:(a,n)=>{const o=e.board.length===3?150:e.board.length===5?100:80;return n?{top:`${o+a*(o+10)}px`}:{left:`${o+a*(o+10)}px`}}}}});function A(e,t,r,i,s,d){const a=f("Cell");return h(),m("section",{class:"field",style:b(e.defineFieldStyle())},[(h(!0),m(C,null,$(e.board.flat(),(n,o)=>(h(),w(a,{gameStatus:e.gameStatus,player:e.player,isWin:e.winCells.includes(o),cell:n,key:o,style:b(e.defineCellStyle()),onClick:l=>e.makeMove(o,n)},null,8,["gameStatus","player","isWin","cell","style","onClick"]))),128)),(h(!0),m(C,null,$(e.board.length-1,(n,o)=>(h(),m("div",{class:"field__line",key:n,style:b(e.defineVerticalStyle(o))},null,4))),128)),(h(!0),m(C,null,$(e.board.length-1,(n,o)=>(h(),m("div",{class:"field__line horizontal",key:n,style:b(e.defineVerticalStyle(o,!0))},null,4))),128))],4)}const F=S(j,[["render",A],["__scopeId","data-v-ac435c43"]]),N=(e,t)=>{const r=e[t];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((i,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))})},U=y({name:"SvgIcon",props:{name:{type:String,required:!0},disableTransition:{type:Boolean,default:!1},disableColorinheritance:{type:Boolean,default:!1}},setup(e){return{svgComponent:R(()=>W(()=>N(Object.assign({"./icons/Cancel.vue":()=>z(()=>import("./Cancel-ad9c75cf.js"),["assets/Cancel-ad9c75cf.js","assets/index-028351f6.js","assets/index-863553dd.css"]),"./icons/Play.vue":()=>z(()=>import("./Play-a71f761a.js"),["assets/Play-a71f761a.js","assets/index-028351f6.js","assets/index-863553dd.css"]),"./icons/Return.vue":()=>z(()=>import("./Return-67d1f294.js"),["assets/Return-67d1f294.js","assets/index-028351f6.js","assets/index-863553dd.css"])}),`./icons/${e.name}.vue`))),defineClass:()=>({inherit:!e.disableColorinheritance,tr:!e.disableTransition})}}});function X(e,t,r,i,s,d){return h(),w(E(e.svgComponent),{class:g(["SVG",e.defineClass()])},null,8,["class"])}const x=S(U,[["render",X]]),J=y({name:"Settings",components:{SvgIcon:x},props:{gameStatus:{type:String,required:!0},historyLen:{type:Number,required:!0},boardSize:{type:Number,required:!0}},emits:["start","cancel","returnMove","setSize"],setup(e,t){return{start:()=>{e.gameStatus!=="start"&&t.emit("start")},cancel:()=>{e.gameStatus!==""&&t.emit("cancel")},returnMove:()=>{e.gameStatus!=="start"||e.historyLen===0||t.emit("returnMove")},setSize:a=>{e.gameStatus==="start"||e.boardSize===a||t.emit("setSize",a)}}}});const K=e=>(B("data-v-7fb8da65"),e=e(),T(),e),Q={class:"set"},Y={class:"set__btns"},Z={class:"set__mode"},ee=K(()=>c("h4",{class:"set__modeName"},"Board Size",-1)),te={class:"set__variants"};function se(e,t,r,i,s,d){const a=f("SvgIcon");return h(),m("section",Q,[c("div",Y,[c("button",{type:"button",class:"set__btn",title:"Play",onClick:t[0]||(t[0]=n=>e.start())},[_(a,{name:"Play",class:"set__svg"})]),c("button",{type:"button",class:"set__btn",title:"Cancel",onClick:t[1]||(t[1]=n=>e.cancel())},[_(a,{name:"Cancel",class:"set__svg"})]),c("button",{type:"button",class:"set__btn",title:"Return move",onClick:t[2]||(t[2]=n=>e.returnMove())},[_(a,{name:"Return",class:"set__svg"})])]),c("div",Z,[ee,c("div",te,[c("button",{type:"button",class:g(["set__variant",{active:e.boardSize===3}]),onClick:t[3]||(t[3]=n=>e.setSize(3))},"3x3",2),c("button",{type:"button",class:g(["set__variant",{active:e.boardSize===5}]),onClick:t[4]||(t[4]=n=>e.setSize(5))},"5x5",2),c("button",{type:"button",class:g(["set__variant",{active:e.boardSize===7}]),onClick:t[5]||(t[5]=n=>e.setSize(7))},"7x7",2)])])])}const re=S(J,[["render",se],["__scopeId","data-v-7fb8da65"]]),ne=y({name:"Panel",props:{result:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0}},setup(e){return{specifyResult:()=>{switch(e.result){case"x":return"Winner X";case"o":return"Winner O";case"d":return"Draw";case"":return""}},defineClass:i=>e.gameStatus===""?"":e.gameStatus==="start"?e.player===i?"active":"":e.result===i?"win":e.result==="d"?"draw":"lose"}}});const k=e=>(B("data-v-d188107c"),e=e(),T(),e),ae={class:"panel"},ie=k(()=>c("div",{class:"panel__x"},null,-1)),oe=[ie],le=k(()=>c("p",{class:"panel__vs"},"VS",-1)),ue=k(()=>c("div",{class:"panel__o"},null,-1)),de=[ue],ve={key:0,class:"panel__result"};function ce(e,t,r,i,s,d){return h(),m("section",ae,[c("div",{class:g(["panel__side left",e.defineClass("x")])},oe,2),le,c("div",{class:g(["panel__side rigth",e.defineClass("o")])},de,2),_(L,{name:"fade"},{default:q(()=>[e.result!==""?(h(),m("div",ve,H(e.specifyResult()),1)):M("",!0)]),_:1})])}const he=S(ne,[["render",ce],["__scopeId","data-v-d188107c"]]);class me{constructor(t=3){u(this,"player");u(this,"board");u(this,"boardSize");u(this,"result");u(this,"history");u(this,"computer");u(this,"gameStatus");u(this,"winCells");u(this,"index1DTo2D",t=>({x:Math.floor(t/this.boardSize.value),y:t%this.boardSize.value}));u(this,"index2Dto1D",t=>t.x*this.boardSize.value+t.y);u(this,"userMove",t=>{if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.board.value[t.x][t.y]===void 0)throw Error("Wrong coordinates");if(this.board.value[t.x][t.y]!=="")throw Error("Cell is not empty");this.makeMove(t),this.computer.value.isComp&&this.compMove(),this.result.value!==""&&this.finishGame()});u(this,"makeMove",t=>{this.board.value[t.x][t.y]=this.player.value,this.history.value.push({...t,cell:this.player.value}),this.player.value=this.player.value==="x"?"o":"x",this.defineResult()});u(this,"compMove",()=>{if(this.result.value!=="")return;const t=this.getAvailableMoves;switch(this.computer.value.mode){case"easy":return this.makeMove(t[Math.floor(Math.random()*t.length)]);case"hard":return this.makeMove(t[Math.floor(Math.random()*t.length)])}});u(this,"reset",()=>{this.player.value="x",this.result.value="",this.board.value=[["","",""],["","",""],["","",""]],this.board.value=this.createBoard(),this.gameStatus.value="",this.history.value=[],this.winCells.value=[]});u(this,"createBoard",()=>{const t=[];for(let r=0;r<this.boardSize.value;r++){const i=[];for(let s=0;s<this.boardSize.value;s++)i.push("");t.push(i)}return t});u(this,"returnMove",()=>{var i;if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.getHistoryLength===0)throw Error("History is empty");if(this.removeMove(),!this.computer.value.isComp||this.getHistoryLength===0)return;(this.computer.value.isFirst?"x":"o")!==((i=this.history.value.at(-1))==null?void 0:i.cell)&&this.removeMove()});u(this,"removeMove",()=>{const t=this.history.value.pop();if(t===void 0){this.player.value="x";return}this.board.value[t.x][t.y]="",this.player.value=t.cell});u(this,"isWin",(t,r)=>{if(t.length!==r.length)throw Error("row and rowCoordinates do not have same length");let i=[];const s=this.boardSize.value===3?3:4,d=t.reduce((n,o,l)=>(n.length===s||((o===""||n.length!==0&&n.at(-1)!==o)&&(n=[],i=[]),n.push(o),i.push(r[l])),n),[]),a=d.length===s;return a&&(this.result.value=d[0],this.winCells.value.push(...i)),a});u(this,"defineResult",()=>{const t=this.boardSize.value===3?5:7;if(this.getHistoryLength<t)return;const r=this.board.value;for(let s=0;s<this.boardSize.value;s++){const d=r.map((a,n)=>({x:s,y:n}));this.isWin(r[s],d)}for(let s=0;s<this.boardSize.value;s++){const d=r.map(n=>n[s]),a=r.map((n,o)=>({x:o,y:s}));this.isWin(d,a)}const i=this.getDiagonals;for(let s=0;s<i[0].length;s++)this.isWin(i[0][s],i[1][s]);this.result.value===""&&(this.result.value=this.getHistoryLength===this.amoutOfCells?"d":"")});u(this,"startGame",()=>{this.gameStatus.value="start",this.computer.value.isComp&&this.computer.value.isFirst&&this.compMove()});u(this,"finishGame",()=>{this.gameStatus.value="finish"});u(this,"setBoardSize",t=>{this.boardSize.value=t,this.reset()});if(![3,5,7].includes(t))throw Error("Wrong size for boardSize, expected: 3, 5, 7");this.player=p("x"),this.result=p(""),this.boardSize=p(t),this.board=p(this.createBoard()),this.computer=p({isComp:!1,isFirst:!1,mode:"easy"}),this.gameStatus=p(""),this.history=p([]),this.winCells=p([])}get getPlayer(){return this.player.value}get getBoard(){return this.board.value}get getBoardSize(){return this.boardSize.value}get getResult(){return this.result.value}get getGameStatus(){return this.gameStatus.value}get getHistoryLength(){return this.history.value.length}get getWinCells(){return this.winCells.value.map(t=>this.index2Dto1D(t))}get amoutOfCells(){return Math.pow(this.boardSize.value,2)}get getAvailableMoves(){return this.board.value.reduce((t,r,i)=>(r.forEach((s,d)=>{s===""&&t.push({x:i,y:d})}),t),[])}get getDiagonals(){const t=this.boardSize.value===3?3:4,r=[],i=[];let s=[],d=[];const a=(o,l)=>{s.push({x:o,y:l}),d.push(this.board.value[o][l])},n=()=>{s.length>=t&&(r.push(s),i.push(d)),s=[],d=[]};for(let o=0;o<this.boardSize.value;o++){for(let l=0;l<this.boardSize.value;l++){const v=o+l;if(v>=this.boardSize.value)break;a(v,l)}n();for(let l=this.boardSize.value-1;l>=0;l--){const v=this.boardSize.value-1+o-l;if(v>=this.boardSize.value)break;a(v,l)}if(n(),o!==0){for(let l=0;l<this.boardSize.value;l++){const v=l-o;v<0||a(v,l)}n();for(let l=this.boardSize.value-1;l>=0;l--){const v=this.boardSize.value-1-o-l;v<0||a(v,l)}n()}}return[i,r]}}const pe=y({name:"TicTacToe",components:{Main:P,Board:F,Settings:re,Panel:he},setup(){return{g:new me}}});const ge={class:"tic__game"};function _e(e,t,r,i,s,d){const a=f("Panel"),n=f("Board"),o=f("Settings"),l=f("Main");return h(),w(l,{class:"tic"},{default:q(()=>[c("div",ge,[_(a,{"game-status":e.g.getGameStatus,result:e.g.getResult,player:e.g.getPlayer},null,8,["game-status","result","player"]),_(n,{winCells:e.g.getWinCells,player:e.g.getPlayer,gameStatus:e.g.getGameStatus,board:e.g.getBoard,onMakeMove:t[0]||(t[0]=v=>e.g.userMove(e.g.index1DTo2D(v)))},null,8,["winCells","player","gameStatus","board"])]),_(o,{class:"tic__setting",historyLen:e.g.getHistoryLength,gameStatus:e.g.getGameStatus,boardSize:e.g.getBoardSize,onReturnMove:t[1]||(t[1]=v=>e.g.returnMove()),onStart:t[2]||(t[2]=v=>e.g.startGame()),onCancel:t[3]||(t[3]=v=>e.g.reset()),onSetSize:t[4]||(t[4]=v=>e.g.setBoardSize(v))},null,8,["historyLen","gameStatus","boardSize"])]),_:1})}const be=S(pe,[["render",_e],["__scopeId","data-v-f2e4e3f1"]]);export{be as default};
