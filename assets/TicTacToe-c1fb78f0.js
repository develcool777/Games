var B=Object.defineProperty;var q=(t,e,r)=>e in t?B(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var u=(t,e,r)=>(q(t,typeof e!="symbol"?e+"":e,r),r);import{M as D}from"./Main-029a18ac.js";import{d as y,h as m,_ as S,c as v,n as f,i as w,o as h,F as C,j as $,k as b,e as k,r as _,l as I,m as P,q as M,s as R,g as p,a as g,w as T,T as W,t as E,p as L,f as H}from"./index-2fa162e9.js";const G=y({name:"Cell",props:{cell:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0},isWin:{type:Boolean,required:!0}},setup(t){const e=m(!1),r=s=>t.cell===s||a(s),a=s=>t.cell===""&&t.player===s&&e.value;return{isHovered:e,isShow:r,defineHovered:a}}});function V(t,e,r,a,s,d){return h(),v("button",{type:"button",class:f(["cell",{win:t.isWin}]),title:"cell",onMouseover:e[0]||(e[0]=i=>t.isHovered=t.gameStatus==="start"),onMouseleave:e[1]||(e[1]=i=>t.isHovered=!1)},[t.isShow("o")?(h(),v("div",{key:0,class:f(["cell__o",{hovered:t.defineHovered("o")}])},null,2)):w("",!0),t.isShow("x")?(h(),v("div",{key:1,class:f(["cell__x",{hovered:t.defineHovered("x")}])},null,2)):w("",!0)],34)}const O=S(G,[["render",V],["__scopeId","data-v-dcb579c1"]]),j=y({name:"Board",components:{Cell:O},props:{board:{type:Object,required:!0},gameStatus:{type:String,required:!0},player:{type:String,required:!0},winCells:{type:Array,required:!0}},emits:["makeMove"],setup(t,e){return{makeMove:(i,n)=>{t.gameStatus!=="start"||n!==""||e.emit("makeMove",i)},defineCellStyle:()=>{const i=t.board.length===3?"150px":t.board.length===5?"100px":"80px";return{width:i,height:i}},defineFieldStyle:()=>{const i=t.board.length===3?"490px":t.board.length===5?"560px":"640px";return{width:i,height:i}},defineVerticalStyle:(i,n)=>{const o=t.board.length===3?150:t.board.length===5?100:80;return n?{top:`${o+i*(o+10)}px`}:{left:`${o+i*(o+10)}px`}}}}});function A(t,e,r,a,s,d){const i=_("Cell");return h(),v("section",{class:"field",style:b(t.defineFieldStyle())},[(h(!0),v(C,null,$(t.board.flat(),(n,o)=>(h(),k(i,{gameStatus:t.gameStatus,player:t.player,isWin:t.winCells.includes(o),cell:n,key:o,style:b(t.defineCellStyle()),onClick:l=>t.makeMove(o,n)},null,8,["gameStatus","player","isWin","cell","style","onClick"]))),128)),(h(!0),v(C,null,$(t.board.length-1,(n,o)=>(h(),v("div",{class:"field__line",key:n,style:b(t.defineVerticalStyle(o))},null,4))),128)),(h(!0),v(C,null,$(t.board.length-1,(n,o)=>(h(),v("div",{class:"field__line horizontal",key:n,style:b(t.defineVerticalStyle(o,!0))},null,4))),128))],4)}const F=S(j,[["render",A],["__scopeId","data-v-ac435c43"]]),x=(t,e)=>{const r=t[e];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((a,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+e)))})},N=y({name:"SvgIcon",props:{name:{type:String,required:!0},disableTransition:{type:Boolean,default:!1},disableColorinheritance:{type:Boolean,default:!1}},setup(t){return{svgComponent:I(()=>P(()=>x(Object.assign({"./icons/Cancel.vue":()=>M(()=>import("./Cancel-0c0bb928.js"),["assets/Cancel-0c0bb928.js","assets/index-2fa162e9.js","assets/index-863553dd.css"]),"./icons/Play.vue":()=>M(()=>import("./Play-9ceb66df.js"),["assets/Play-9ceb66df.js","assets/index-2fa162e9.js","assets/index-863553dd.css"]),"./icons/Return.vue":()=>M(()=>import("./Return-4d2a9991.js"),["assets/Return-4d2a9991.js","assets/index-2fa162e9.js","assets/index-863553dd.css"])}),`./icons/${t.name}.vue`))),defineClass:()=>({inherit:!t.disableColorinheritance,tr:!t.disableTransition})}}});function U(t,e,r,a,s,d){return h(),k(R(t.svgComponent),{class:f(["SVG",t.defineClass()])},null,8,["class"])}const X=S(N,[["render",U]]),J=y({name:"Settings",components:{SvgIcon:X},props:{gameStatus:{type:String,required:!0},historyLen:{type:Number,required:!0}},emits:["start","cancel","returnMove"],setup(t,e){return{start:()=>{t.gameStatus!=="start"&&e.emit("start")},cancel:()=>{t.gameStatus!==""&&e.emit("cancel")},returnMove:()=>{t.gameStatus!=="start"||t.historyLen===0||e.emit("returnMove")}}}});const K={class:"set"},Q={class:"set__btns"},Y={type:"button",title:"Cancel"},Z={type:"button",title:"Return move"};function ee(t,e,r,a,s,d){const i=_("SvgIcon");return h(),v("section",K,[p("div",Q,[p("button",{type:"button",title:"Play",onClick:e[0]||(e[0]=n=>t.start())},[g(i,{name:"Play",class:"set__svg"})]),p("button",Y,[g(i,{name:"Cancel",class:"set__svg",onClick:e[1]||(e[1]=n=>t.cancel())})]),p("button",Z,[g(i,{name:"Return",class:"set__svg",onClick:e[2]||(e[2]=n=>t.returnMove())})])])])}const te=S(J,[["render",ee],["__scopeId","data-v-7686c1c8"]]),se=y({name:"Panel",props:{result:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0}},setup(t){return{specifyResult:()=>{switch(t.result){case"x":return"Winner X";case"o":return"Winner O";case"d":return"Draw";case"":return""}},defineClass:a=>t.gameStatus===""?"":t.gameStatus==="start"?t.player===a?"active":"":t.result===a?"win":t.result==="d"?"draw":"lose"}}});const z=t=>(L("data-v-8e7a4a35"),t=t(),H(),t),re={class:"panel"},ne=z(()=>p("div",{class:"panel__x"},null,-1)),ae=[ne],ie=z(()=>p("p",{class:"panel__vs"},"VS",-1)),oe=z(()=>p("div",{class:"panel__o"},null,-1)),le=[oe],ue={key:0,class:"panel__result"};function de(t,e,r,a,s,d){return h(),v("section",re,[p("div",{class:f(["panel__side left",t.defineClass("x")])},ae,2),ie,p("div",{class:f(["panel__side rigth",t.defineClass("o")])},le,2),g(W,{name:"fade"},{default:T(()=>[t.result!==""?(h(),v("div",ue,E(t.specifyResult()),1)):w("",!0)]),_:1})])}const ce=S(se,[["render",de],["__scopeId","data-v-8e7a4a35"]]);class he{constructor(e=3){u(this,"player");u(this,"board");u(this,"boardSize");u(this,"result");u(this,"history");u(this,"computer");u(this,"gameStatus");u(this,"winCells");u(this,"index1DTo2D",e=>({x:Math.floor(e/this.boardSize.value),y:e%this.boardSize.value}));u(this,"index2Dto1D",e=>e.x*this.boardSize.value+e.y);u(this,"userMove",e=>{if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.board.value[e.x][e.y]===void 0)throw Error("Wrong coordinates");if(this.board.value[e.x][e.y]!=="")throw Error("Cell is not empty");this.makeMove(e),this.computer.value.isComp&&this.compMove(),this.result.value!==""&&this.finishGame()});u(this,"makeMove",e=>{this.board.value[e.x][e.y]=this.player.value,this.history.value.push({...e,cell:this.player.value}),this.player.value=this.player.value==="x"?"o":"x",this.defineResult()});u(this,"compMove",()=>{if(this.result.value!=="")return;const e=this.getAvailableMoves;switch(this.computer.value.mode){case"easy":return this.makeMove(e[Math.floor(Math.random()*e.length)]);case"hard":return this.makeMove(e[Math.floor(Math.random()*e.length)])}});u(this,"reset",()=>{this.player.value="x",this.result.value="",this.board.value=[["","",""],["","",""],["","",""]],this.board.value=this.createBoard(),this.gameStatus.value="",this.history.value=[],this.winCells.value=[]});u(this,"createBoard",()=>{const e=[];for(let r=0;r<this.boardSize.value;r++){const a=[];for(let s=0;s<this.boardSize.value;s++)a.push("");e.push(a)}return e});u(this,"returnMove",()=>{var e,r;if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.getHistoryLength===0)throw Error("History is empty");this.removeMove(),this.computer.value.isComp&&this.getHistoryLength!==0&&(this.computer.value.isFirst?"x":"o")!==((e=this.history.value.at(-1))==null?void 0:e.cell)&&this.removeMove(),this.player.value=((r=this.history.value.at(-1))==null?void 0:r.cell)??"x"});u(this,"removeMove",()=>{const e=this.history.value.pop();e!==void 0&&(this.board.value[e.x][e.y]="")});u(this,"isWin",(e,r)=>{if(e.length!==r.length)throw Error("row and rowCoordinates do not have same length");let a=[];const s=this.boardSize.value===3?3:4,d=e.reduce((n,o,l)=>(n.length===s||((o===""||n.length!==0&&n.at(-1)!==o)&&(n=[],a=[]),n.push(o),a.push(r[l])),n),[]),i=d.length===s;return i&&(this.result.value=d[0],this.winCells.value=a),i});u(this,"defineResult",()=>{const e=this.boardSize.value===3?5:7;if(this.getHistoryLength<e)return;const r=this.board.value;for(let s=0;s<this.boardSize.value;s++){const d=r.map((i,n)=>({x:s,y:n}));if(this.isWin(r[s],d))return}for(let s=0;s<this.boardSize.value;s++){const d=r.map(n=>n[s]),i=r.map((n,o)=>({x:o,y:s}));if(this.isWin(d,i))return}const a=this.getDiagonals;for(let s=0;s<a[0].length;s++)if(this.isWin(a[0][s],a[1][s]))return;this.result.value=this.getHistoryLength===this.amoutOfCells?"d":""});u(this,"startGame",()=>{this.gameStatus.value="start",this.computer.value.isComp&&this.computer.value.isFirst&&this.compMove()});u(this,"finishGame",()=>{this.gameStatus.value="finish"});if(![3,5,7].includes(e))throw Error("Wrong size for boardSize, expected: 3, 5, 7");this.player=m("x"),this.result=m(""),this.boardSize=m(e),this.board=m(this.createBoard()),this.computer=m({isComp:!1,isFirst:!1,mode:"easy"}),this.gameStatus=m(""),this.history=m([]),this.winCells=m([])}get getPlayer(){return this.player.value}get getBoard(){return this.board.value}get getBoardSize(){return this.boardSize.value}get getResult(){return this.result.value}get getGameStatus(){return this.gameStatus.value}get getHistoryLength(){return this.history.value.length}get getWinCells(){return this.winCells.value.map(e=>this.index2Dto1D(e))}get amoutOfCells(){return Math.pow(this.boardSize.value,2)}get getAvailableMoves(){return this.board.value.reduce((e,r,a)=>(r.forEach((s,d)=>{s===""&&e.push({x:a,y:d})}),e),[])}get getDiagonals(){const e=this.boardSize.value===3?3:4,r=[],a=[];let s=[],d=[];const i=(o,l)=>{s.push({x:o,y:l}),d.push(this.board.value[o][l])},n=()=>{s.length>=e&&(r.push(s),a.push(d)),s=[],d=[]};for(let o=0;o<this.boardSize.value;o++){for(let l=0;l<this.boardSize.value;l++){const c=o+l;if(c>=this.boardSize.value)break;i(c,l)}n();for(let l=this.boardSize.value-1;l>=0;l--){const c=this.boardSize.value-1+o-l;if(c>=this.boardSize.value)break;i(c,l)}if(n(),o!==0){for(let l=0;l<this.boardSize.value;l++){const c=l-o;c<0||i(c,l)}n();for(let l=this.boardSize.value-1;l>=0;l--){const c=this.boardSize.value-1-o-l;c<0||i(c,l)}n()}}return[a,r]}}const ve=y({name:"TicTacToe",components:{Main:D,Board:F,Settings:te,Panel:ce},setup(){return{g:new he(7)}}});const pe={class:"tic__game"};function me(t,e,r,a,s,d){const i=_("Panel"),n=_("Board"),o=_("Settings"),l=_("Main");return h(),k(l,{class:"tic"},{default:T(()=>[p("div",pe,[g(i,{"game-status":t.g.getGameStatus,result:t.g.getResult,player:t.g.getPlayer},null,8,["game-status","result","player"]),g(n,{winCells:t.g.getWinCells,player:t.g.getPlayer,gameStatus:t.g.getGameStatus,board:t.g.getBoard,onMakeMove:e[0]||(e[0]=c=>t.g.userMove(t.g.index1DTo2D(c)))},null,8,["winCells","player","gameStatus","board"])]),g(o,{historyLen:t.g.getHistoryLength,gameStatus:t.g.getGameStatus,onReturnMove:e[1]||(e[1]=c=>t.g.returnMove()),onStart:e[2]||(e[2]=c=>t.g.startGame()),onCancel:e[3]||(e[3]=c=>t.g.reset())},null,8,["historyLen","gameStatus"])]),_:1})}const ye=S(ve,[["render",me],["__scopeId","data-v-24cd6290"]]);export{ye as default};
