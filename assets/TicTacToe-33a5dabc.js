var P=Object.defineProperty;var H=(e,t,i)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var d=(e,t,i)=>(H(e,typeof t!="symbol"?t+"":t,i),i);import{M as G}from"./Main-e5c1d857.js";import{d as S,h as g,_ as b,c as m,n as p,i as M,o as h,F as w,j as k,k as C,e as D,r as y,l as V,m as j,q as z,s as F,g as u,a as _,p as R,f as E,w as L,T as N,t as A,u as U}from"./index-7c1b05ba.js";const X=S({name:"Cell",props:{cell:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0},isWin:{type:Boolean,required:!0}},setup(e){const t=g(!1),i=s=>e.cell===s||r(s),r=s=>e.cell===""&&e.player===s&&t.value;return{isHovered:t,isShow:i,defineHovered:r}}});function J(e,t,i,r,s,c){return h(),m("button",{type:"button",class:p(["cell",{win:e.isWin}]),title:"cell",onMouseover:t[0]||(t[0]=l=>e.isHovered=e.gameStatus==="start"),onMouseleave:t[1]||(t[1]=l=>e.isHovered=!1)},[e.isShow("o")?(h(),m("div",{key:0,class:p(["cell__o",{hovered:e.defineHovered("o")}])},null,2)):M("",!0),e.isShow("x")?(h(),m("div",{key:1,class:p(["cell__x",{hovered:e.defineHovered("x")}])},null,2)):M("",!0)],34)}const K=b(X,[["render",J],["__scopeId","data-v-a4462563"]]),Q=S({name:"Board",components:{Cell:K},props:{board:{type:Object,required:!0},gameStatus:{type:String,required:!0},player:{type:String,required:!0},winCells:{type:Array,required:!0}},emits:["makeMove"],setup(e,t){return{makeMove:(l,a)=>{e.gameStatus!=="start"||a!==""||t.emit("makeMove",l)},defineCellStyle:()=>{const l=e.board.length===3?"150px":e.board.length===5?"100px":"80px";return{width:l,height:l}},defineFieldStyle:()=>{const l=e.board.length===3?"490px":e.board.length===5?"560px":"640px";return{width:l,height:l}},defineVerticalStyle:(l,a)=>{const o=e.board.length===3?150:e.board.length===5?100:80;return a?{top:`${o+l*(o+10)}px`}:{left:`${o+l*(o+10)}px`}}}}});function Y(e,t,i,r,s,c){const l=y("Cell");return h(),m("section",{class:"field",style:C(e.defineFieldStyle())},[(h(!0),m(w,null,k(e.board.flat(),(a,o)=>(h(),D(l,{gameStatus:e.gameStatus,player:e.player,isWin:e.winCells.includes(o),cell:a,key:o,style:C(e.defineCellStyle()),onClick:n=>e.makeMove(o,a)},null,8,["gameStatus","player","isWin","cell","style","onClick"]))),128)),(h(!0),m(w,null,k(e.board.length-1,(a,o)=>(h(),m("div",{class:"field__line",key:a,style:C(e.defineVerticalStyle(o))},null,4))),128)),(h(!0),m(w,null,k(e.board.length-1,(a,o)=>(h(),m("div",{class:"field__line horizontal",key:a,style:C(e.defineVerticalStyle(o,!0))},null,4))),128))],4)}const Z=b(Q,[["render",Y],["__scopeId","data-v-ac435c43"]]),x=(e,t)=>{const i=e[t];return i?typeof i=="function"?i():Promise.resolve(i):new Promise((r,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))})},ee=S({name:"SvgIcon",props:{name:{type:String,required:!0},disableTransition:{type:Boolean,default:!1},disableColorinheritance:{type:Boolean,default:!1}},setup(e){return{svgComponent:V(()=>j(()=>x(Object.assign({"./icons/Cancel.vue":()=>z(()=>import("./Cancel-6d6967c6.js"),["assets/Cancel-6d6967c6.js","assets/index-7c1b05ba.js","assets/index-863553dd.css"]),"./icons/Play.vue":()=>z(()=>import("./Play-6f374eeb.js"),["assets/Play-6f374eeb.js","assets/index-7c1b05ba.js","assets/index-863553dd.css"]),"./icons/Return.vue":()=>z(()=>import("./Return-365011df.js"),["assets/Return-365011df.js","assets/index-7c1b05ba.js","assets/index-863553dd.css"])}),`./icons/${e.name}.vue`))),defineClass:()=>({inherit:!e.disableColorinheritance,tr:!e.disableTransition})}}});function te(e,t,i,r,s,c){return h(),D(F(e.svgComponent),{class:p(["SVG",e.defineClass()])},null,8,["class"])}const se=b(ee,[["render",te]]),ie=S({name:"Settings",components:{SvgIcon:se},props:{gameStatus:{type:String,required:!0},historyLen:{type:Number,required:!0},config:{type:Object,requird:!0}},emits:["start","cancel","returnMove","setConfig"],setup(e,t){return{start:()=>{e.gameStatus!=="start"&&t.emit("start")},cancel:()=>{e.gameStatus!==""&&t.emit("cancel")},returnMove:()=>{e.gameStatus!=="start"||e.historyLen===0||t.emit("returnMove")},setSize:n=>{var v;e.gameStatus==="start"||((v=e.config)==null?void 0:v.boardSize)===n||t.emit("setConfig",{boardSize:n})},setOpponent:n=>{t.emit("setConfig",{opponent:n})},setSide:n=>{t.emit("setConfig",{side:n})},setDifficulty:n=>{t.emit("setConfig",{difficulty:n})}}}});const $=e=>(R("data-v-7b948fe2"),e=e(),E(),e),ne={class:"set"},oe={class:"set__btns"},re={class:"set__mode"},ae=$(()=>u("h4",{class:"set__modeName"},"Board Size",-1)),le={class:"set__variants"},ue={class:"set__mode"},de=$(()=>u("h4",{class:"set__modeName"},"Opponent",-1)),ve={class:"set__variants"},ce={class:"set__mode"},pe=$(()=>u("h4",{class:"set__modeName"},"Side",-1)),he={class:"set__variants"},me={class:"set__mode"},fe=$(()=>u("h4",{class:"set__modeName"},"Difficulty",-1)),ge={class:"set__variants"};function _e(e,t,i,r,s,c){var a,o,n,v,B,W,I,O,q;const l=y("SvgIcon");return h(),m("section",ne,[u("div",oe,[u("button",{type:"button",class:"set__btn",title:"Play",onClick:t[0]||(t[0]=f=>e.start())},[_(l,{name:"Play",class:"set__svg"})]),u("button",{type:"button",class:"set__btn",title:"Cancel",onClick:t[1]||(t[1]=f=>e.cancel())},[_(l,{name:"Cancel",class:"set__svg"})]),u("button",{type:"button",class:"set__btn",title:"Return move",onClick:t[2]||(t[2]=f=>e.returnMove())},[_(l,{name:"Return",class:"set__svg"})])]),u("div",re,[ae,u("div",le,[u("button",{type:"button",class:p(["set__variant",{active:((a=e.config)==null?void 0:a.boardSize)===3}]),onClick:t[3]||(t[3]=f=>e.setSize(3))},"3x3",2),u("button",{type:"button",class:p(["set__variant",{active:((o=e.config)==null?void 0:o.boardSize)===5}]),onClick:t[4]||(t[4]=f=>e.setSize(5))},"5x5",2),u("button",{type:"button",class:p(["set__variant",{active:((n=e.config)==null?void 0:n.boardSize)===7}]),onClick:t[5]||(t[5]=f=>e.setSize(7))},"7x7",2)])]),u("div",ue,[de,u("div",ve,[u("button",{type:"button",class:p(["set__variant",{active:((v=e.config)==null?void 0:v.opponent)==="user"}]),onClick:t[6]||(t[6]=f=>e.setOpponent("user"))},"User",2),u("button",{type:"button",class:p(["set__variant",{active:((B=e.config)==null?void 0:B.opponent)==="comp"}]),onClick:t[7]||(t[7]=f=>e.setOpponent("comp"))},"Computer",2)])]),u("div",ce,[pe,u("div",he,[u("button",{type:"button",class:p(["set__variant",{active:((W=e.config)==null?void 0:W.side)==="x"}]),onClick:t[8]||(t[8]=f=>e.setSide("x"))},"X",2),u("button",{type:"button",class:p(["set__variant",{active:((I=e.config)==null?void 0:I.side)==="o"}]),onClick:t[9]||(t[9]=f=>e.setSide("o"))},"O",2)])]),u("div",me,[fe,u("div",ge,[u("button",{type:"button",class:p(["set__variant",{active:((O=e.config)==null?void 0:O.difficulty)==="easy"}]),onClick:t[10]||(t[10]=f=>e.setDifficulty("easy"))},"Easy",2),u("button",{type:"button",class:p(["set__variant",{active:((q=e.config)==null?void 0:q.difficulty)==="hard"}]),onClick:t[11]||(t[11]=f=>e.setDifficulty("hard"))},"Hard",2)])])])}const ye=b(ie,[["render",_e],["__scopeId","data-v-7b948fe2"]]),Se=S({name:"Panel",props:{result:{type:String,required:!0},player:{type:String,required:!0},gameStatus:{type:String,required:!0}},setup(e){return{specifyResult:()=>{switch(e.result){case"x":return"Winner X";case"o":return"Winner O";case"d":return"Draw";case"":return""}},defineClass:r=>e.gameStatus===""?"":e.gameStatus==="start"?e.player===r?"active":"":e.result===r?"win":e.result==="d"?"draw":"lose"}}});const T=e=>(R("data-v-d188107c"),e=e(),E(),e),be={class:"panel"},Ce=T(()=>u("div",{class:"panel__x"},null,-1)),$e=[Ce],we=T(()=>u("p",{class:"panel__vs"},"VS",-1)),ke=T(()=>u("div",{class:"panel__o"},null,-1)),ze=[ke],Me={key:0,class:"panel__result"};function De(e,t,i,r,s,c){return h(),m("section",be,[u("div",{class:p(["panel__side left",e.defineClass("x")])},$e,2),we,u("div",{class:p(["panel__side rigth",e.defineClass("o")])},ze,2),_(N,{name:"fade"},{default:L(()=>[e.result!==""?(h(),m("div",Me,A(e.specifyResult()),1)):M("",!0)]),_:1})])}const Te=b(Se,[["render",De],["__scopeId","data-v-d188107c"]]);class Be{constructor(t=3){d(this,"player");d(this,"board");d(this,"boardSize");d(this,"result");d(this,"history");d(this,"computer");d(this,"gameStatus");d(this,"winCells");d(this,"worker",null);d(this,"index1DTo2D",t=>({x:Math.floor(t/this.boardSize.value),y:t%this.boardSize.value}));d(this,"index2Dto1D",t=>t.x*this.boardSize.value+t.y);d(this,"userMove",t=>{if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.board.value[t.x][t.y]===void 0)throw Error("Wrong coordinates");if(this.board.value[t.x][t.y]!=="")throw Error("Cell is not empty");this.makeMove(t),this.computer.value.isComp&&this.compMove(),this.result.value!==""&&this.finishGame()});d(this,"compMove",()=>{if(this.result.value!=="")return;this.worker===null&&(this.worker=new Worker(new URL("/Games/assets/tictactoe-6bb470e3.js",self.location),{type:"module"}));const t={board:this.board.value,player:this.player.value,level:this.computer.value.level};this.worker.postMessage(JSON.stringify(t)),this.worker.onmessage=i=>{const r=i.data;if(r===null)throw Error("AI move is null");this.makeMove(r)}});d(this,"makeMove",t=>{this.board.value[t.x][t.y]=this.player.value,this.history.value.push({...t,cell:this.player.value}),this.player.value=this.player.value==="x"?"o":"x",this.defineResult()});d(this,"reset",()=>{this.player.value="x",this.result.value="",this.board.value=[["","",""],["","",""],["","",""]],this.board.value=this.createBoard(),this.gameStatus.value="",this.history.value=[],this.winCells.value=[]});d(this,"createBoard",()=>{const t=[];for(let i=0;i<this.boardSize.value;i++){const r=[];for(let s=0;s<this.boardSize.value;s++)r.push("");t.push(r)}return t});d(this,"returnMove",()=>{var r;if(this.gameStatus.value!=="start")throw Error("Game is not started");if(this.getHistoryLength===0)throw Error("History is empty");if(this.removeMove(),!this.computer.value.isComp||this.getHistoryLength===0)return;(this.computer.value.isFirst?"x":"o")!==((r=this.history.value.at(-1))==null?void 0:r.cell)&&this.removeMove()});d(this,"removeMove",()=>{const t=this.history.value.pop();if(t===void 0){this.player.value="x";return}this.board.value[t.x][t.y]="",this.player.value=t.cell});d(this,"isWin",(t,i)=>{if(t.length!==i.length)throw Error("row and rowCoordinates do not have same length");let r=[];const s=this.boardSize.value===3?3:4,c=t.reduce((a,o,n)=>(a.length===s||((o===""||a.length!==0&&a.at(-1)!==o)&&(a=[],r=[]),a.push(o),r.push(i[n])),a),[]),l=c.length===s;return l&&(this.result.value=c[0],this.winCells.value.push(...r)),l});d(this,"defineResult",()=>{const t=this.boardSize.value===3?5:7;if(this.getHistoryLength<t)return;const i=this.board.value;for(let s=0;s<this.boardSize.value;s++){const c=i.map((l,a)=>({x:s,y:a}));this.isWin(i[s],c)}for(let s=0;s<this.boardSize.value;s++){const c=i.map(a=>a[s]),l=i.map((a,o)=>({x:o,y:s}));this.isWin(c,l)}const r=this.getDiagonals;for(let s=0;s<r[0].length;s++)this.isWin(r[0][s],r[1][s]);this.result.value===""&&(this.result.value=this.getHistoryLength===this.amoutOfCells?"d":"")});d(this,"startGame",()=>{this.gameStatus.value="start",this.computer.value.isComp&&this.computer.value.isFirst&&this.compMove()});d(this,"finishGame",()=>{this.gameStatus.value="finish"});d(this,"defineConfig",t=>{t.boardSize&&(this.boardSize.value=t.boardSize),t.difficulty&&(this.computer.value.level=t.difficulty),t.opponent&&(this.computer.value.isComp=t.opponent==="comp"),t.side&&(this.computer.value.isFirst=t.side==="o"),this.reset()});d(this,"terminateWorker",()=>{this.worker!==null&&(this.worker.terminate(),this.worker=null)});if(![3,5,7].includes(t))throw Error("Wrong size for boardSize, expected: 3, 5, 7");this.player=g("x"),this.result=g(""),this.boardSize=g(t),this.board=g(this.createBoard()),this.computer=g({isComp:!1,isFirst:!1,level:"easy"}),this.gameStatus=g(""),this.history=g([]),this.winCells=g([])}get getPlayer(){return this.player.value}get getBoard(){return this.board.value}get getBoardSize(){return this.boardSize.value}get getResult(){return this.result.value}get getGameStatus(){return this.gameStatus.value}get getHistoryLength(){return this.history.value.length}get getWinCells(){return this.winCells.value.map(t=>this.index2Dto1D(t))}get getConfig(){return{boardSize:this.boardSize.value,opponent:this.computer.value.isComp?"comp":"user",side:this.computer.value.isFirst?"o":"x",difficulty:this.computer.value.level}}get amoutOfCells(){return Math.pow(this.boardSize.value,2)}get getDiagonals(){const t=this.boardSize.value===3?3:4,i=[],r=[];let s=[],c=[];const l=(o,n)=>{s.push({x:o,y:n}),c.push(this.board.value[o][n])},a=()=>{s.length>=t&&(i.push(s),r.push(c)),s=[],c=[]};for(let o=0;o<this.boardSize.value;o++){for(let n=0;n<this.boardSize.value;n++){const v=o+n;if(v>=this.boardSize.value)break;l(v,n)}a();for(let n=this.boardSize.value-1;n>=0;n--){const v=this.boardSize.value-1+o-n;if(v>=this.boardSize.value)break;l(v,n)}if(a(),o!==0){for(let n=0;n<this.boardSize.value;n++){const v=n-o;v<0||l(v,n)}a();for(let n=this.boardSize.value-1;n>=0;n--){const v=this.boardSize.value-1-o-n;v<0||l(v,n)}a()}}return[r,i]}}const We=S({name:"TicTacToe",components:{Main:G,Board:Z,Settings:ye,Panel:Te},setup(){const e=new Be;return U(()=>e.terminateWorker()),{g:e}}});const Ie={class:"tic__game"};function Oe(e,t,i,r,s,c){const l=y("Panel"),a=y("Board"),o=y("Settings"),n=y("Main");return h(),D(n,{class:"tic"},{default:L(()=>[u("div",Ie,[_(l,{"game-status":e.g.getGameStatus,result:e.g.getResult,player:e.g.getPlayer},null,8,["game-status","result","player"]),_(a,{winCells:e.g.getWinCells,player:e.g.getPlayer,gameStatus:e.g.getGameStatus,board:e.g.getBoard,onMakeMove:t[0]||(t[0]=v=>e.g.userMove(e.g.index1DTo2D(v)))},null,8,["winCells","player","gameStatus","board"])]),_(o,{class:"tic__setting",historyLen:e.g.getHistoryLength,gameStatus:e.g.getGameStatus,config:e.g.getConfig,onReturnMove:t[1]||(t[1]=v=>e.g.returnMove()),onStart:t[2]||(t[2]=v=>e.g.startGame()),onSetConfig:t[3]||(t[3]=v=>e.g.defineConfig(v)),onCancel:t[4]||(t[4]=v=>e.g.reset())},null,8,["historyLen","gameStatus","config"])]),_:1})}const Le=b(We,[["render",Oe],["__scopeId","data-v-9bff2cae"]]);export{Le as default};
